<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.bootstrap4.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.3.2/bootbox.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/responsive.bootstrap4.min.js"></script>

    <title>Old Activity</title>
    <script>
        $(document).ready(function () {

            $("#addcalender").click(function () {



            });
            $("#drop").click(function () {
                $("#first").attr('disabled', true);

            });

            var dataSet = [
                {
                    "date": '1/11/62',
                    "name": "วิ่งเพื่อสุขภาพ",
                    "organize": "สุรพง",
                    "info": "วิ่งเพื่อสุขภาพเพิ่อเสริมสรัางสุขภาพ",
                },
                {
                    "date": "8/11/62",
                    "name": "โรงเรียนผู้สูงอายุ",
                    "organize": "สุรพง",
                    "info": "เรียนรู้เรื่องราวใหม่ๆ วัดบัานแม่เลียบ ต.โชคชัย",
                },
                {
                    "date": "15/11/62",
                    "name": "มินิมาราทอนผู้สูงอายุ",
                    "organize": "สุรพง",
                    "info": "วิ่งเพื่อสุขภาพเพิ่อเสริมสรัางสุขภาพ ณ บ้านป่าลัน",
                },
                {
                    "date": "20/11/62",
                    "name": "ปลูกป่า",
                    "organize": "สุรพง",
                    "info": "รักสิ่งแวดล้อม ปลูกป่าชุมชน ณ บ้านแม่เลียบ ",
                },
                {
                    "date": "26/11/62",
                    "name": "เดินวิ่งเพื่อสุขภาพ",
                    "organize": "สุรพง",
                    "info": "วิ่งเพื่อสุขภาพเพิ่อเสริมสรัางสุขภาพ บ้านใหม่ดอนงาม",
                },
                {
                    "date": "30/11/62",
                    "name": "วิ่งตามฝัน",
                    "organize": "สุรพง",
                    "info": "วิ่งเพื่อสุขภาพเพิ่อเสริมสรัางสุขภาพ บ้านซ้อ",

                },

            ];

            var table = $('#myTable').DataTable({
                responsive: true,       //for responsive column display
                deferRender: true,      //if large data, use this option
                data: dataSet,
                columns: [
                    { data: "date", title: "วันที่" },
                    { data: "name", title: "กิจกรรม" },
                    { data: "organize", title: "ผู้จัดงาน" },
                    { data: "info", title: "รายละเอียด" },
                    { title: "Action", orderable: false, defaultContent: "<button class='btn btn-danger my-1'>ลบ</button> <button class='btn btn-warning my-1'>แก้ไข</button>" }
                ],
                columnDefs: [
                    // make the last column align right, also target: "_all"
                    { "className": "dt-center", "targets": 3 }
                ]
            });
            // Delete 
            $('#myTable tbody').on('click', '.btn-danger', function () {
                var gun = table.row($(this).parents('tr')).data();
                // console.log(data.id);

                gun.date = dataSet.splice;
                gun.name = dataSet.splice;
                gun.organize = dataSet.splice;
                gun.info = dataSet.splice;
                $(this).parents("tr").remove();
                // console.log(data);
                // let id = $("#txtId").val();
                // $( this ).parent("tr").remove();
                // for (i = 0; i < dataSet.length; i++) {
                //     if (dataSet[i].id == data["id"]) {
                //         var delet = dataSet[i].id;
                //         table.row($(this).parents('tr')).remove().draw(false);
                //         break;
                //     }

            });

            // Edit
            $('#myTable tbody').on('click', '.btn-warning', function () {
                // read data of the selected row
                check = 1;
                var data = table.row($(this).parents('tr')).data();

                // show data in modal

                $("#date").val(data.date);
                $("#txtName").val(data.name);
                if (data.gender == "Male") {
                    $("#radioMale").prop('checked', 'true');
                }
                else {
                    $("#radioFemale").prop('checked', 'true');
                }
                $("#txtMajor").val(data.major);
                $("#txtSchool").val(data.school);

                // show modal
                $("#txtId").attr('disabled', true)

                $("#modalEdit").modal("show");

            });

            // Edit and save
            $("#btnSave").click(function () {
                if (check == 1) {
                    let date = $("#date").val();
                    let name = $("#txtName").val();
                    let gender = $("#radioMale").is(":checked") ? "Male" : "Female";
                    let major = $("#txtMajor").val();
                    let school = $("#txtSchool").val();
                    // console.log(id+" "+name+" "+gender+" "+major+" "+school);

                    //search JS object array for "id"
                    for (var i = 0; i < dataSet.length; i++) {
                        if (dataSet[i].id == id) {
                            break;
                        }
                    }

                    //close modal
                    $("#modalEdit").modal('hide');
                    //get selected row and update value

                    let temp = table.row(i).data();
                    temp.name = name;
                    temp.gender = gender;
                    temp.major = major;
                    temp.school = school;

                    //update data table
                    table.row(i).data(temp).invalidate();
                } else {
                    let date = $("#date").val();
                    let name = $("#txtName").val();
                    let gender = $("#radioMale").is(":checked") ? "Male" : "Female";
                    let major = $("#txtMajor").val();
                    let school = $("#txtSchool").val();
                    //  console.log(id+" "+name+" "+gender+" "+major+" "+school); 

                    //close modal
                    $("#modalEdit").modal('hide');
                    table.row.add({
                        "date": date,
                        "name": name,
                        "gender": gender,
                        "major": major,
                        "school": school

                    }).draw();
                }
                console.log("hello")

            });
            $("#add").click(function () {
                check = 0;
                $("#date").val("");
                $("#txtName").val("");
                $("#radioMale").prop('checked', 'true');
                $("#txtMajor").val("");
                $("#txtSchool").val("");
                $("#modalEdit").modal("show");

            });
        });
    </script>
    <style>
        #logout {
            border: 2px solid red;
            color: red;
        }

        h4 {
            text-align: center;
        }

        #c {
            text-align: center;
        }

        #d {
            color: red;
        }

        .carousel-caption h3 span {
            background-color: black;
            padding: 15px;
        }

        .carousel-caption p span {

            background-color: black;
            padding: 15px;
        }

        .carousel-caption h3 {
            font-size: 40px;
        }

        .carousel-caption p {
            font-size: 30px;
        }

        .carousel-caption {
            position: absolute;
            top: 40%;
            left: 1.8%;
            right: auto;
            width: 96.66666666666666%;
            color: #fff;
        }
    </style>
</head>

<body>
    <div class="container">

        <nav class="navbar navbar-expand-sm navbar-dark bg-dark mb-3">
            <a class="navbar-brand" href="#">logo</a>
            <button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse"
                data-target="#collapsibleNavId" aria-controls="collapsibleNavId" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="collapsibleNavId">
                <form class="form-inline">
                    <input class="form-control mr-sm-2" type="text" placeholder="Search">
                    <button class="btn btn-success" type="submit">ค้นหา</button>
                    <button type="button" class="btn btn-success ml-2" type="submit">เข้าสู่ระบบ</button>
                </form>


                <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">หน้าหลัก <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">ข้อมูลผู้สูงอายุ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">กิจกรรม</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"></a>
                    </li>

                </ul>
                <button class="btn btn-danger">ออกจากระบบ</button>


            </div>
        </nav>
        <div class="col-12">
            <button id="add" class="btn btn-success float-right mb-3">Add</button>
        </div>
        <table id="myTable" class="table table-striped table-bordered" style="width:100%">
        </table>

        <!-- Modal -->
        <div class="modal fade" id="modalEdit">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="modelTitleId">Edit</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <input type="date" class="form-control mb-1" id="date" >
                        <input type="text" class="form-control mb-1" id="txtName" placeholder="Name-Surname">
                        <input type="radio" name="gender" id="radioMale"> Male
                        <input type="radio" name="gender" id="radioFemale"> Female
                        <input type="text" class="form-control my-1" id="txtMajor" placeholder="Major">
                        <input type="text" class="form-control mb-1" id="txtSchool" placeholder="School">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button id="btnSave" type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="container-fluid">
        <footer style="background-color: #343a40">
            <div class="container-fluid padding">
                <div class="row text-center text-light">
                    <div class="col-md-4">
                        <hr class="light">
                        <h5>ฉุกเฉิน</h5>
                        <hr class="light">
                        <div class="row">
                            <div class="col-sm-12" id="d">
                                <img src="support.png" alt="" width="30">
                                โทร: 091-2828333
                            </div>


                        </div>
                    </div>
                    <div class="col-md-4">
                        <hr class="light">
                        <h5>เกี่ยวกับเรา</h5>
                        <hr class="light">
                        <p class="mt-2">ศูนย์จัดเตรียมกิจกรรมมากมายเพื่อผู้สูงอายุ
                            และข่าวประชาสัมพันธ์เรื่องสุขภาพเพื่อชีวิตที่ดีขึ้น</p>


                    </div>



                    <div class="col-md-4">
                        <hr class="light">
                        <h5>ติดต่อเรา</h5>
                        <hr class="light">
                        <p class="mt-1">Office: 02-222-0000</p>
                        <p>Address:City, State, 00000</p>

                    </div>

                </div>
            </div>
        </footer>

</body>

</html>